<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-A">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ToolVerse - Your Gateway to Powerful Web Apps</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <style>
        /* Custom animation for text reveal */
        @keyframes fadeInDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fadeInDown {
            animation: fadeInDown 0.8s ease-out forwards;
        }
        .opacity-0-initial { opacity: 0; } /* For elements starting hidden before animation */
        .delay-200 { animation-delay: 0.2s; }
        .delay-400 { animation-delay: 0.4s; }
        .delay-600 { animation-delay: 0.6s; }

        /* For scroll animations */
        .reveal-on-scroll {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }
        .revealed {
            opacity: 1;
            transform: translateY(0);
        }

        /* Carousel Styles */
        .carousel-slide {
            transition: opacity 1.5s ease-in-out;
        }
        .carousel-slide:not(.active) {
            opacity: 0;
            pointer-events: none; /* Prevent interaction with hidden slides */
        }
        .carousel-slide.active {
            opacity: 1;
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-100 font-sans antialiased">

    <!-- Navbar -->
    <nav class="bg-gray-800/80 backdrop-blur-md shadow-lg fixed w-full z-50 top-0">
        {% block "navbar" %}
        <div class="container mx-auto px-6 py-3 flex justify-between items-center">
            <a href="{% url 'home' %}" class="text-2xl font-bold text-white hover:text-teal-400 transition-colors">
                <i class="fas fa-tools mr-2"></i>ToolVerse
            </a>
            <div class="hidden md:flex space-x-4 items-center">
                <a href="{% url 'home' %}#hero" class="text-gray-300 hover:text-teal-400 transition-colors">Home</a>
                <a href="{% url 'home' %}#featured-apps" class="text-gray-300 hover:text-teal-400 transition-colors">Apps</a>
                <a href="{% url 'home' %}#why-us" class="text-gray-300 hover:text-teal-400 transition-colors">Features</a>
                <a href="#" class="text-gray-300 hover:text-teal-400 transition-colors">About</a>
                <a href="{% url 'login' %}" class="text-gray-300 hover:text-teal-400 transition-colors">Login</a>
                <a href="{% url 'register' %}" class="bg-teal-500 hover:bg-teal-600 text-white font-semibold py-2 px-4 rounded-lg transition-colors">Sign Up</a>
            </div>
            <div class="md:hidden">
                <button id="nav-toggle" class="text-gray-300 hover:text-teal-400 focus:outline-none">
                    <i class="fas fa-bars text-xl"></i>
                </button>
            </div>
        </div>
        <!-- Mobile Nav -->
        <div id="mobile-nav" class="md:hidden hidden bg-gray-800 p-4 space-y-2">
            <a href="{% url 'home' %}#hero" class="block text-gray-300 hover:text-teal-400 transition-colors">Home</a>
            <a href="{% url 'home' %}#featured-apps" class="block text-gray-300 hover:text-teal-400 transition-colors">Apps</a>
            <a href="{% url 'home' %}#why-us" class="block text-gray-300 hover:text-teal-400 transition-colors">Features</a>
            <a href="#" class="block text-gray-300 hover:text-teal-400 transition-colors">About</a>
            {% if user.is_authenticated %}
            <a href="{% url 'logout' %}" class="block text-gray-300 hover:text-teal-400 transition-colors">Logout</a>
            {% else %}
            <a href="{% url 'login' %}" class="block text-gray-300 hover:text-teal-400 transition-colors">Login</a>
            <a href="{% url 'register' %}" class="block bg-teal-500 hover:bg-teal-600 text-white font-semibold py-2 px-4 rounded-lg transition-colors text-center">Sign Up</a>
            {% endif %}
        </div>
        {% endblock %}
    </nav>

    <!-- Hero Section with Image Carousel -->
    {% include "sections/hero.html" %}

    <!-- Why Us Section -->
    {% include "sections/why_us.html" %}

    <!-- Featured Apps Section -->
    {% include "sections/featured_apps.html" %}

    <!-- How It Works Section -->
    {% include "sections/how_it_works.html" %}

    <!-- CTA Section -->
    {% include "sections/cta.html" %}

    <!-- Footer -->
    {% include "sections/footer.html" %}

    <script>
        // Mobile Nav Toggle
        const navToggle = document.getElementById('nav-toggle');
        const mobileNav = document.getElementById('mobile-nav');
        if (navToggle && mobileNav) {
            navToggle.addEventListener('click', () => {
                mobileNav.classList.toggle('hidden');
            });
        }

        // Smooth scroll for nav links
        const homeUrl = "{% url 'home' %}".replace(/\/$/, ""); // Get base home URL without trailing slash

        document.querySelectorAll('a.js-smooth-scroll-home[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                const href = this.getAttribute('href'); // Should be like "#section-id"
                const targetId = href; // The href itself is the target ID selector

                // Check if we are currently on the home page
                const onHomePage = window.location.pathname === homeUrl || window.location.pathname === homeUrl + '/' || window.location.pathname === '/';

                if (onHomePage) {
                    e.preventDefault();
                    const targetElement = document.querySelector(targetId);
                    if (targetElement) {
                        targetElement.scrollIntoView({
                            behavior: 'smooth'
                        });
                    }
                    // Close mobile nav if open after click
                    const mobileNav = document.getElementById('mobile-nav');
                    if (mobileNav && !mobileNav.classList.contains('hidden')) {
                        mobileNav.classList.add('hidden');
                    }
                } else {
                    // If not on the home page, navigate to home page with the hash
                    window.location.href = homeUrl + '/' + targetId;
                }
            });
        });


        // Current Year for Footer
        const currentYearElement = document.getElementById('currentYear');
        if (currentYearElement) {
            currentYearElement.textContent = new Date().getFullYear();
        }

        // Simple Scroll Reveal Animation
        const revealElements = document.querySelectorAll('.reveal-on-scroll');
        if (typeof IntersectionObserver !== 'undefined') {
            const revealObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('revealed');
                        // Optional: unobserve after revealing to save resources
                        // revealObserver.unobserve(entry.target);
                    }
                });
            }, {
                threshold: 0.1 // Trigger when 10% of the element is visible
            });

            revealElements.forEach(el => {
                revealObserver.observe(el);
            });
        } else {
            // Fallback for older browsers: just show the elements
            revealElements.forEach(el => el.classList.add('revealed'));
        }


        // Hero Carousel
        const carousel = document.getElementById('hero-carousel');
        const dotsContainer = document.getElementById('carousel-dots');
        let slides = [];
        if (carousel) {
            slides = Array.from(carousel.querySelectorAll('.carousel-slide'));
        }
        
        let currentSlide = 0;
        const slideIntervalTime = 5000; // 5 seconds
        let autoSlideInterval;

        function showSlide(index) {
            if (!slides.length) return;

            slides.forEach((slide, i) => {
                slide.classList.remove('active');
                if (i === index) {
                    slide.classList.add('active');
                }
            });
            // Update dots
            if (dotsContainer) {
                const dots = dotsContainer.querySelectorAll('button');
                dots.forEach((dot, i) => {
                    dot.classList.toggle('bg-white', i === index);
                    dot.classList.toggle('bg-gray-500', i !== index);
                    dot.setAttribute('aria-current', i === index);
                });
            }
            currentSlide = index;
        }

        function nextSlide() {
            if (!slides.length) return;
            showSlide((currentSlide + 1) % slides.length);
        }

        function prevSlide() {
            if (!slides.length) return;
            showSlide((currentSlide - 1 + slides.length) % slides.length);
        }

        if (slides.length > 0) {
            // Create dots
            if (dotsContainer) {
                dotsContainer.innerHTML = ''; // Clear existing dots if any
                slides.forEach((_, i) => {
                    const dot = document.createElement('button');
                    dot.classList.add('w-3', 'h-3', 'rounded-full', 'transition-colors', 'duration-300', 'focus:outline-none', 'focus:ring-2', 'focus:ring-teal-300');
                    dot.setAttribute('aria-label', `Go to slide ${i + 1}`);
                    dot.classList.toggle('bg-white', i === 0);
                    dot.classList.toggle('bg-gray-500', i !== 0);
                    dot.addEventListener('click', () => {
                        showSlide(i);
                        clearInterval(autoSlideInterval); // Reset interval on manual navigation
                        autoSlideInterval = setInterval(nextSlide, slideIntervalTime);
                    });
                    dotsContainer.appendChild(dot);
                });
            }

            showSlide(0); // Show first slide initially
            autoSlideInterval = setInterval(nextSlide, slideIntervalTime);

            // Optional: Pause on hover
            carousel.addEventListener('mouseenter', () => clearInterval(autoSlideInterval));
            carousel.addEventListener('mouseleave', () => autoSlideInterval = setInterval(nextSlide, slideIntervalTime));

        }

        // Ensure hero text animations trigger after page load if opacity-0-initial is used
        document.addEventListener('DOMContentLoaded', () => {
            const heroTexts = document.querySelectorAll('#hero .animate-fadeInDown.opacity-0-initial');
            heroTexts.forEach(text => {
                // Small delay to ensure CSS is fully loaded and animation plays smoothly
                setTimeout(() => text.classList.remove('opacity-0-initial'), 50);
            });
        });

    </script>
</body>
</html>