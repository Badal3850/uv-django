{% extends "base.html" %} {# Make sure this path is correct #}
{% load static %}

{% block title %}ToolVerse - Your Gateway to Powerful Web Apps{% endblock title %}

{% block extra_styles %}
    {# Styles specific to the homepage content (carousel, animations) #}
    <style>
        /* Custom animation for hero text reveal */
        @keyframes fadeInDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fadeInDown {
            animation: fadeInDown 0.8s ease-out forwards;
        }
        .opacity-0-initial { opacity: 0; } /* Start hidden for animation */
        .delay-200 { animation-delay: 0.2s; }
        .delay-400 { animation-delay: 0.4s; }
        .delay-600 { animation-delay: 0.6s; }

        /* For scroll reveal animations on homepage sections */
        .reveal-on-scroll {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }
        .revealed {
            opacity: 1;
            transform: translateY(0);
        }

        /* Hero Carousel Styles */
        .carousel-slide {
            transition: opacity 1.5s ease-in-out;
            position: absolute; /* Ensure they stack correctly */
            inset: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
        }
        .carousel-slide:not(.active) {
            opacity: 0;
            pointer-events: none; 
        }
        .carousel-slide.active {
            opacity: 1;
        }
    </style>
{% endblock extra_styles %}

{% block navbar %}
    {# The homepage uses the default navbar from base.html.
       If you wanted a transparent-on-top-then-solid-on-scroll navbar for ONLY the homepage,
       you would override this block and implement that custom navbar logic here.
       For now, we'll assume the base navbar is sufficient or you'll add that later. #}
    {{ block.super }} {# This includes the navbar from base.html #}
{% endblock navbar %}


{% block content %}
    <!-- Hero Section with Image Carousel -->
    <section id="hero" class="relative min-h-screen flex items-center justify-center text-white overflow-hidden pt-16"> {# pt-16 for navbar height #}
        <div id="hero-carousel" class="absolute inset-0 w-full h-full">
            <!-- Slide 1 -->
            <div class="carousel-slide active"
                 style="background-image: url('https://images.unsplash.com/photo-1517694712202-14dd9538aa97?auto=format&fit=crop&w=1920&q=80');">
                <div class="absolute inset-0 bg-black/60"></div>
            </div>
            <!-- Slide 2 -->
            <div class="carousel-slide"
                 style="background-image: url('https://images.unsplash.com/photo-1551288049-bebda4e38f71?auto=format&fit=crop&w=1920&q=80');">
                <div class="absolute inset-0 bg-black/60"></div>
            </div>
            <!-- Slide 3 -->
            <div class="carousel-slide"
                 style="background-image: url('https://images.unsplash.com/photo-1498050108023-c5249f4df085?auto=format&fit=crop&w=1920&q=80');">
                <div class="absolute inset-0 bg-black/60"></div>
            </div>
        </div>

        <div class="relative z-10 text-center p-6 max-w-3xl mx-auto">
            <h1 class="text-4xl sm:text-5xl md:text-6xl lg:text-7xl font-extrabold mb-6 animate-fadeInDown opacity-0-initial">
                Discover <span class="text-teal-300">Powerful</span> Web Tools
            </h1>
            <p class="text-lg sm:text-xl md:text-2xl mb-8 text-gray-200 animate-fadeInDown delay-200 opacity-0-initial">
                Your ultimate hub for innovative, Python-powered applications designed to boost productivity and streamline your workflow.
            </p>
            <a href="#featured-apps" class="js-smooth-scroll-home bg-white text-gray-900 hover:bg-gray-200 font-bold py-3 px-8 rounded-lg text-lg shadow-xl transform hover:scale-105 transition-all duration-300 animate-fadeInDown delay-400 opacity-0-initial">
                Explore Tools <i class="fas fa-arrow-right ml-2"></i>
            </a>
        </div>

        <div id="carousel-dots" class="absolute bottom-8 left-1/2 transform -translate-x-1/2 z-10 flex space-x-2">
            {# Dots will be generated by JS in extra_scripts #}
        </div>
    </section>

    <!-- Why Us Section -->
    <section id="why-us" class="py-16 md:py-24 bg-gray-800">
        <div class="container mx-auto px-6">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-12 text-teal-400 reveal-on-scroll">
                Why Choose ToolVerse?
            </h2>
            <div class="grid md:grid-cols-3 gap-8 text-center">
                <div class="bg-gray-700/50 p-8 rounded-xl shadow-xl hover:shadow-teal-500/30 transition-shadow duration-300 reveal-on-scroll">
                    <i class="fas fa-cogs text-5xl text-teal-400 mb-6"></i>
                    <h3 class="text-2xl font-semibold mb-3 text-white">Python-Powered Precision</h3>
                    <p class="text-gray-300">Leveraging Python's versatility for robust, scalable, and efficient backend solutions.</p>
                </div>
                <div class="bg-gray-700/50 p-8 rounded-xl shadow-xl hover:shadow-teal-500/30 transition-shadow duration-300 reveal-on-scroll delay-200">
                    <i class="fas fa-rocket text-5xl text-teal-400 mb-6"></i>
                    <h3 class="text-2xl font-semibold mb-3 text-white">Boost Your Productivity</h3>
                    <p class="text-gray-300">Tools designed to automate tasks, simplify complex processes, and save you valuable time.</p>
                </div>
                <div class="bg-gray-700/50 p-8 rounded-xl shadow-xl hover:shadow-teal-500/30 transition-shadow duration-300 reveal-on-scroll delay-400">
                    <i class="fas fa-shield-alt text-5xl text-teal-400 mb-6"></i>
                    <h3 class="text-2xl font-semibold mb-3 text-white">Secure & Reliable</h3>
                    <p class="text-gray-300">Built with security best practices, ensuring your data and operations are safe.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Featured Apps Section -->
    <section id="featured-apps" class="py-16 md:py-24 bg-gray-900">
        <div class="container mx-auto px-6">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-12 text-teal-400 reveal-on-scroll">
                Featured Tools
            </h2>
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                {# This part should be populated from your Django view context: featured_apps #}
                {% if featured_apps %}
                    {% for app_tool in featured_apps %} {# Changed variable name to avoid conflict if 'app' is used by allauth #}
                    <div class="bg-gray-800 rounded-xl shadow-2xl overflow-hidden transform hover:scale-105 transition-transform duration-300 group reveal-on-scroll {% cycle '' 'delay-200' 'delay-400' %}">
                        <div class="p-6">
                            <div class="flex items-center mb-4">
                                <div class="bg-{{ app_tool.accent_color_class|default:'teal' }}-500/20 p-3 rounded-lg mr-4 group-hover:bg-{{ app_tool.accent_color_class|default:'teal' }}-500/40 transition-colors">
                                    {% if app_tool.icon_image %}
                                        <img src="{{ app_tool.icon_image.url }}" alt="{{ app_tool.name }} icon" class="w-8 h-8 object-contain">
                                    {% else %}
                                        <i class="{{ app_tool.font_awesome_icon_class|default:'fas fa-tools' }} text-3xl text-{{ app_tool.accent_color_class|default:'teal' }}-400"></i>
                                    {% endif %}
                                </div>
                                <h3 class="text-2xl font-semibold text-white">{{ app_tool.name }}</h3>
                            </div>
                            <p class="text-gray-300 mb-4 h-20 overflow-hidden"> {# Fixed height for description consistency #}
                                {{ app_tool.short_description|truncatewords:20 }}
                            </p>
                            <a href="{{ app_tool.get_absolute_url }}" class="inline-block text-{{ app_tool.accent_color_class|default:'teal' }}-400 hover:text-{{ app_tool.accent_color_class|default:'teal' }}-300 font-semibold group-hover:underline">
                                Learn More <i class="fas fa-angle-right ml-1"></i>
                            </a>
                        </div>
                        <div class="bg-{{ app_tool.accent_color_class|default:'teal' }}-600 h-2 w-0 group-hover:w-full transition-all duration-500"></div>
                    </div>
                    {% endfor %}
                {% else %}
                    {# Placeholder if no featured_apps #}
                    {% for i in "123" %} {# Dummy loop for 3 cards #}
                    <div class="bg-gray-800 rounded-xl shadow-2xl overflow-hidden transform hover:scale-105 transition-transform duration-300 group reveal-on-scroll {% cycle '' 'delay-200' 'delay-400' %}">
                        <div class="p-6">
                            <div class="flex items-center mb-4">
                                <div class="bg-teal-500/20 p-3 rounded-lg mr-4 group-hover:bg-teal-500/40 transition-colors">
                                    <i class="fas fa-spider text-3xl text-teal-400"></i>
                                </div>
                                <h3 class="text-2xl font-semibold text-white">DataScrape Pro {{ i }}</h3>
                            </div>
                            <p class="text-gray-300 mb-4 h-20 overflow-hidden">Effortlessly extract data from any website. Schedule scrapes and export to multiple formats.</p>
                            <a href="#" class="inline-block text-teal-400 hover:text-teal-300 font-semibold group-hover:underline">Learn More <i class="fas fa-angle-right ml-1"></i></a>
                        </div>
                        <div class="bg-teal-600 h-2 w-0 group-hover:w-full transition-all duration-500"></div>
                    </div>
                    {% endfor %}
                {% endif %}
            </div>
            <div class="text-center mt-12 reveal-on-scroll delay-600">
                <a href="#" class="bg-teal-500 hover:bg-teal-600 text-white font-bold py-3 px-8 rounded-lg text-lg shadow-lg transform hover:scale-105 transition-all duration-300">
                    View All Tools {# This should link to your all_apps page #}
                </a>
            </div>
        </div>
    </section>

    <!-- How It Works Section -->
    <section id="how-it-works" class="py-16 md:py-24 bg-gray-800">
        <div class="container mx-auto px-6">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-16 text-teal-400 reveal-on-scroll">
                Get Started in 3 Easy Steps
            </h2>
            <div class="relative">
                <!-- Connecting line (desktop) -->
                <div class="hidden md:block absolute top-1/2 left-0 w-full h-0.5 bg-gray-700 -translate-y-1/2" style="z-index: -1;"></div>
                
                <div class="flex flex-col md:flex-row justify-around items-start md:items-center space-y-12 md:space-y-0 md:space-x-8 relative">
                    <!-- Step 1 -->
                    <div class="text-center reveal-on-scroll w-full md:w-1/3">
                        <div class="relative bg-gray-800 border-2 border-teal-500 rounded-full w-24 h-24 flex items-center justify-center mx-auto mb-4 shadow-lg">
                            <i class="fas fa-mouse-pointer text-4xl text-teal-300"></i>
                            <span class="absolute -top-3 -right-3 bg-teal-500 text-white text-xs font-bold w-8 h-8 rounded-full flex items-center justify-center border-2 border-gray-800">1</span>
                        </div>
                        <h3 class="text-xl font-semibold text-white mb-2">Explore & Choose</h3>
                        <p class="text-gray-400 max-w-xs mx-auto">Browse our curated collection and find the perfect tool for your needs.</p>
                    </div>
                    <!-- Step 2 -->
                    <div class="text-center reveal-on-scroll delay-200 w-full md:w-1/3">
                         <div class="relative bg-gray-800 border-2 border-teal-500 rounded-full w-24 h-24 flex items-center justify-center mx-auto mb-4 shadow-lg">
                            <i class="fas fa-user-plus text-4xl text-teal-300"></i>
                             <span class="absolute -top-3 -right-3 bg-teal-500 text-white text-xs font-bold w-8 h-8 rounded-full flex items-center justify-center border-2 border-gray-800">2</span>
                        </div>
                        <h3 class="text-xl font-semibold text-white mb-2">Sign Up / Log In</h3>
                        <p class="text-gray-400 max-w-xs mx-auto">Create an account or log in to access your dashboard and tools via our secure modal.</p>
                    </div>
                    <!-- Step 3 -->
                    <div class="text-center reveal-on-scroll delay-400 w-full md:w-1/3">
                        <div class="relative bg-gray-800 border-2 border-teal-500 rounded-full w-24 h-24 flex items-center justify-center mx-auto mb-4 shadow-lg">
                            <i class="fas fa-bolt text-4xl text-teal-300"></i>
                            <span class="absolute -top-3 -right-3 bg-teal-500 text-white text-xs font-bold w-8 h-8 rounded-full flex items-center justify-center border-2 border-gray-800">3</span>
                        </div>
                        <h3 class="text-xl font-semibold text-white mb-2">Power Up Your Workflow</h3>
                        <p class="text-gray-400 max-w-xs mx-auto">Start using the tools immediately and experience enhanced productivity.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- CTA Section -->
    <section class="py-16 md:py-24 bg-gradient-to-br from-gray-900 via-teal-800/30 to-gray-900">
        <div class="container mx-auto px-6 text-center">
            <h2 class="text-3xl md:text-4xl font-bold text-white mb-6 reveal-on-scroll">
                Ready to Supercharge Your Tasks?
            </h2>
            <p class="text-lg md:text-xl text-gray-200 mb-8 max-w-2xl mx-auto reveal-on-scroll delay-200">
                Join ToolVerse today and unlock a world of powerful web applications. New tools added regularly!
            </p>
            <button data-modal-target="authModal" data-initial-form="signup"
               class="modal-trigger bg-white text-gray-900 hover:bg-gray-200 font-bold py-3 px-10 rounded-lg text-lg shadow-xl
                      transform hover:scale-105 transition-all duration-300 reveal-on-scroll delay-400">
                Sign Up For Free
            </button>
        </div>
    </section>
{% endblock content %}


{% block extra_scripts %}
    {# JavaScript specific to the homepage (Carousel, ScrollReveal, Hero Text Animation) #}
    {# This script block appends to any scripts in base.html's extra_scripts block (if any) #}
    <script>
    document.addEventListener('DOMContentLoaded', function () {
        // --- Scroll Reveal Animation ---
        const revealElements = document.querySelectorAll('.reveal-on-scroll');
        if (typeof IntersectionObserver !== 'undefined') {
            const revealObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => { 
                    if (entry.isIntersecting) {
                        entry.target.classList.add('revealed');
                        // Optional: unobserve after revealing to save resources for one-time animations
                        // revealObserver.unobserve(entry.target); 
                    }
                });
            }, { threshold: 0.1 }); // Adjust threshold as needed
            revealElements.forEach(el => revealObserver.observe(el));
        } else { // Fallback for older browsers
            revealElements.forEach(el => el.classList.add('revealed'));
        }

        // --- Hero Carousel ---
        const carousel = document.getElementById('hero-carousel');
        const dotsContainer = document.getElementById('carousel-dots');
        let slides = [];
        if (carousel) {
            slides = Array.from(carousel.querySelectorAll('.carousel-slide'));
        }
        
        let currentSlide = 0;
        const slideIntervalTime = 5000; // 5 seconds
        let autoSlideInterval;

        function updateCarouselDots(activeIndex) {
            if (!dotsContainer) return;
            const dots = dotsContainer.querySelectorAll('button');
            dots.forEach((dot, i) => {
                dot.classList.toggle('bg-white', i === activeIndex);
                dot.classList.toggle('bg-gray-500', i !== activeIndex);
                dot.setAttribute('aria-current', i === activeIndex ? 'true' : 'false');
            });
        }

        function showSlide(index) {
            if (!slides.length || index < 0 || index >= slides.length) return;
            slides.forEach((slide, i) => {
                slide.classList.toggle('active', i === index);
            });
            updateCarouselDots(index);
            currentSlide = index;
        }

        function nextSlide() {
            if (!slides.length) return;
            let newIndex = (currentSlide + 1) % slides.length;
            showSlide(newIndex);
        }

        if (slides.length > 0) {
            if (dotsContainer) {
                dotsContainer.innerHTML = ''; // Clear existing dots
                slides.forEach((_, i) => {
                    const dot = document.createElement('button');
                    dot.classList.add('w-2.5', 'h-2.5', 'rounded-full', 'transition-colors', 'duration-300', 'focus:outline-none', 'focus:ring-2', 'focus:ring-teal-300', 'mx-1');
                    dot.setAttribute('aria-label', `Go to slide ${i + 1}`);
                    dot.addEventListener('click', () => {
                        showSlide(i);
                        clearInterval(autoSlideInterval); // Reset interval on manual nav
                        autoSlideInterval = setInterval(nextSlide, slideIntervalTime);
                    });
                    dotsContainer.appendChild(dot);
                });
            }
            showSlide(0); // Show first slide initially
            autoSlideInterval = setInterval(nextSlide, slideIntervalTime);

            if(carousel) { // Optional: Pause on hover
                carousel.addEventListener('mouseenter', () => clearInterval(autoSlideInterval));
                carousel.addEventListener('mouseleave', () => autoSlideInterval = setInterval(nextSlide, slideIntervalTime));
            }
        }

        // --- Hero Text Animation Trigger ---
        const heroTexts = document.querySelectorAll('#hero .animate-fadeInDown.opacity-0-initial');
        heroTexts.forEach(text => {
            // Small delay to ensure CSS is fully loaded and animation plays smoothly
            setTimeout(() => text.classList.remove('opacity-0-initial'), 50);
        });

    }); // End DOMContentLoaded for homepage specific scripts
    </script>
{% endblock extra_scripts %}